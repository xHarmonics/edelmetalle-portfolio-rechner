<!DOCTYPE html>
<html lang="de">
<attent
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edelmetall-Portfolio Rechner</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<div class="container">
    <h1>Portfolio Rechner</h1>

    <div class="mode-switch">
        <button class="mode-btn active" id="btnManual" onclick="setMode('manual')">Manuell</button>
        <button class="mode-btn" id="btnLive" onclick="setMode('live')">Live Preise - Coming Soon</button>
    </div>
    <div style="text-align:center; margin-bottom:15px; display:none;" id="liveControl">
        <button class="refresh-btn" style="display:inline-block;" onclick="fetchLivePrices()" disabled>↻ Alle Preise aktualisieren </button>
        <div id="statusMsg" style="font-size:0.8rem; color:#666; margin-top:5px;"></div>
    </div>

    <div class="tabs">
        <button class="tab-btn active-gold" onclick="openTab('gold')">Gold</button>
        <button class="tab-btn" onclick="openTab('silver')">Silber</button>
        <button class="tab-btn" onclick="openTab('platinum')">Platin</button>
        <button class="tab-btn" onclick="openTab('copper')">Kupfer</button>
    </div>

    <div id="section-gold" class="content-section active">
        <div class="price-section">
            <label>Goldpreis (999) pro Gramm in €</label>
            <div class="price-input-wrapper">
                <input type="number" id="price-gold" value="0" step="0.01" oninput="calculate()">
            </div>
        </div>
        <div class="metal-list">
            <div class="metal-item">
                <div class="metal-label"><span>8 Karat</span><small>Gold 333 (33,3%)</small></div>
                <div class="input-group">
                    <input type="number" class="metal-input" data-metal="gold" data-purity="0.333" placeholder="0" oninput="calculate()">
                    <span class="unit">g</span>
                </div>
            </div>
            <div class="metal-item">
                <div class="metal-label"><span>14 Karat</span><small>Gold 585 (58,5%)</small></div>
                <div class="input-group">
                    <input type="number" class="metal-input" data-metal="gold" data-purity="0.585" placeholder="0" oninput="calculate()">
                    <span class="unit">g</span>
                </div>
            </div>
            <div class="metal-item">
                <div class="metal-label"><span>18 Karat</span><small>Gold 750 (75,0%)</small></div>
                <div class="input-group">
                    <input type="number" class="metal-input" data-metal="gold" data-purity="0.750" placeholder="0" oninput="calculate()">
                    <span class="unit">g</span>
                </div>
            </div>
            <div class="metal-item">
                <div class="metal-label"><span>22 Karat</span><small>Gold 916 (91,6%)</small></div>
                <div class="input-group">
                    <input type="number" class="metal-input" data-metal="gold" data-purity="0.916" value="0" oninput="calculate()">
                    <span class="unit">g</span>
                </div>
            </div>
            <div class="metal-item">
                <div class="metal-label"><span>24 Karat</span><small>Gold 999 (Feingold)</small></div>
                <div class="input-group">
                    <input type="number" class="metal-input" data-metal="gold" data-purity="0.999" placeholder="0" oninput="calculate()">
                    <span class="unit">g</span>
                </div>
            </div>
        </div>
    </div>

    <div id="section-silver" class="content-section">
        <div class="price-section">
            <label>Silberpreis (999) pro Gramm in €</label>
            <div class="price-input-wrapper">
                <input type="number" id="price-silver" value="0" step="0.01" oninput="calculate()">
            </div>
        </div>
        <div class="metal-list">
            <div class="metal-item">
                <div class="metal-label"><span>Silber 800</span><small>Besteck/Korpusware</small></div>
                <div class="input-group">
                    <input type="number" class="metal-input" data-metal="silver" data-purity="0.800" placeholder="0" oninput="calculate()">
                    <span class="unit">g</span>
                </div>
            </div>
            <div class="metal-item">
                <div class="metal-label"><span>Silber 835</span><small>Gebrauchssilber</small></div>
                <div class="input-group">
                    <input type="number" class="metal-input" data-metal="silver" data-purity="0.835" placeholder="0" oninput="calculate()">
                    <span class="unit">g</span>
                </div>
            </div>
            <div class="metal-item">
                <div class="metal-label"><span>Sterling 925</span><small>Schmuck/Münzen</small></div>
                <div class="input-group">
                    <input type="number" class="metal-input" data-metal="silver" data-purity="0.925" placeholder="0" oninput="calculate()">
                    <span class="unit">g</span>
                </div>
            </div>
            <div class="metal-item">
                <div class="metal-label"><span>Feinsilber 999</span><small>Barren/Münzen</small></div>
                <div class="input-group">
                    <input type="number" class="metal-input" data-metal="silver" data-purity="0.999" placeholder="0" oninput="calculate()">
                    <span class="unit">g</span>
                </div>
            </div>
        </div>
    </div>

    <div id="section-platinum" class="content-section">
        <div class="price-section">
            <label>Platinpreis (999) pro Gramm in €</label>
            <div class="price-input-wrapper">
                <input type="number" id="price-platinum" value="0" step="0.01" oninput="calculate()">
            </div>
        </div>
        <div class="metal-list">
            <div class="metal-item">
                <div class="metal-label"><span>Platin 950</span><small>Schmuckstandard</small></div>
                <div class="input-group">
                    <input type="number" class="metal-input" data-metal="platinum" data-purity="0.950" placeholder="0" oninput="calculate()">
                    <span class="unit">g</span>
                </div>
            </div>
            <div class="metal-item">
                <div class="metal-label"><span>Feinplatin 999</span><small>Barren/Münzen</small></div>
                <div class="input-group">
                    <input type="number" class="metal-input" data-metal="platinum" data-purity="0.999" placeholder="0" oninput="calculate()">
                    <span class="unit">g</span>
                </div>
            </div>
        </div>
    </div>

    <div id="section-copper" class="content-section">
        <div class="price-section">
            <label>Kupferpreis (999) pro Gramm in €</label>
            <div class="price-input-wrapper">
                <input type="number" id="price-copper" value="0" step="0.001" oninput="calculate()">
            </div>
        </div>
        <div class="metal-list">
             <div class="metal-item">
                <div class="metal-label"><span>Feinkupfer 999</span><small>Barren/Münzen</small></div>
                <div class="input-group">
                    <input type="number" class="metal-input" data-metal="copper" data-purity="0.999" placeholder="0" oninput="calculate()">
                    <span class="unit">g</span>
                </div>
            </div>
        </div>
    </div>

    <div class="total-summary">
        <div class="total-label">Gesamtwert Portfolio</div>
        <div class="total-value" id="totalPortfolioValue">35.223,86 €</div>
        
        <div class="breakdown">
            <div class="breakdown-item" style="color:var(--primary-gold)">Gold: <span class="breakdown-val" id="val-gold">35.223,86 €</span></div>
            <div class="breakdown-item" style="color:var(--primary-silver)">Silber: <span class="breakdown-val" id="val-silver">0,00 €</span></div>
            <div class="breakdown-item" style="color:var(--primary-platinum)">Platin: <span class="breakdown-val" id="val-platinum">0,00 €</span></div>
            <div class="breakdown-item" style="color:var(--primary-copper)">Kupfer: <span class="breakdown-val" id="val-copper">0,00 €</span></div>
        </div>
    </div>

</div>

<script>
    let currentMode = 'manual';

    // UI Tab Logic
    function openTab(metal) {
        document.querySelectorAll('.content-section').forEach(el => el.classList.remove('active'));
        document.getElementById('section-' + metal).classList.add('active');
        
        document.querySelectorAll('.tab-btn').forEach(btn => btn.className = 'tab-btn');
        const activeBtn = document.querySelector(`.tab-btn[onclick="openTab('${metal}')"]`);
        activeBtn.classList.add(`active-${metal}`);
    }

    // Mode Logic
    function setMode(mode) {
        currentMode = mode;
        const inputs = document.querySelectorAll('.price-section input');
        const liveControl = document.getElementById('liveControl');
        const btnManual = document.getElementById('btnManual');
        const btnLive = document.getElementById('btnLive');

        if (mode === 'manual') {
            inputs.forEach(inp => inp.disabled = false);
            liveControl.style.display = 'none';
            btnManual.classList.add('active');
            btnLive.classList.remove('active');
        } else {
            inputs.forEach(inp => inp.disabled = true);
            liveControl.style.display = 'block';
            btnManual.classList.remove('active');
            btnLive.classList.add('active');
            // fetchLivePrices();
        }
    }

    // Mock Live Prices
    /*
    function fetchLivePrices() {
        const statusMsg = document.getElementById('statusMsg');
        statusMsg.innerText = "Lade Kurse...";
        
        setTimeout(() => {
            const prices = {
                gold: (Math.random() * (130 - 126) + 126).toFixed(2),
                silver: (Math.random() * (0.95 - 0.85) + 0.85).toFixed(2),
                platinum: (Math.random() * (32 - 28) + 28).toFixed(2),
                copper: (Math.random() * (0.012 - 0.008) + 0.008).toFixed(3) 
            };

            document.getElementById('price-gold').value = prices.gold;
            document.getElementById('price-silver').value = prices.silver;
            document.getElementById('price-platinum').value = prices.platinum;
            document.getElementById('price-copper').value = prices.copper;

            statusMsg.innerText = "❗ACHTUNG❗: Dies sind nur Beispiel Kurspreise.";
            calculate();
        }, 500);
    }
    */

    // Berechnung
    function calculate() {
        const metals = ['gold', 'silver', 'platinum', 'copper'];
        let grandTotal = 0;

        metals.forEach(metal => {
            const priceInput = document.getElementById(`price-${metal}`).value;
            const pricePerGram = parseFloat(priceInput) || 0;

            const inputs = document.querySelectorAll(`.metal-input[data-metal="${metal}"]`);
            let metalTotal = 0;

            inputs.forEach(input => {
                const weight = parseFloat(input.value) || 0;
                const purity = parseFloat(input.getAttribute('data-purity'));
                if (weight > 0) {
                    metalTotal += (weight * purity * pricePerGram);
                }
            });

            document.getElementById(`val-${metal}`).innerText = metalTotal.toLocaleString('de-DE', { style: 'currency', currency: 'EUR' });
            grandTotal += metalTotal;
        });

        document.getElementById('totalPortfolioValue').innerText = grandTotal.toLocaleString('de-DE', { style: 'currency', currency: 'EUR' });
    }
    
    // Init Calculation on Load (für die Demo Werte)
    window.onload = calculate;
</script>

</body>
</html>